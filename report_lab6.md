# Контейнеры Лаборатория - Docker

Получите практический опыт работы с основами Docker с помощью практического управления контейнерами, операций с образами, сетевых задач и задач хранения.

## Задача 1: Основные операции с контейнерами

**Цель**: Освоить базовое управление жизненным циклом контейнеров.

1. **Список контейнеров**

```sh
docker ps -a
```

Запишите вывод в файл Markdown с именем `submission6.md` в папке лаборатории.

2. **Извлечение образа Ubuntu**

```sh
docker pull ubuntu:latest
```

Размер образа документа в файле `submission6.md`.

3. **Запуск интерактивного контейнера**

```sh
docker run -it --name ubuntu_container ubuntu:latest
```

Выход из контейнера с помощью `exit`.

4. **Удалить образ**

```sh
docker rmi ubuntu:latest
```

Обратите внимание на сообщение об ошибке и объясните, почему удаление не удается в файле `submission6.md`.

## Задача 2: Настройка образа

**Цель**: Создать и развернуть пользовательские образы.

1. **Экспорт образа**

```sh
docker save -o ubuntu_image.tar ubuntu:latest
```

Сравните размер tar с исходным образом. Объясните любые различия, если они есть, в том же файле `submission6.md`.

2. **Развертывание Nginx**

```sh
docker run -d -p 80:80 --name nginx_container nginx
```

Проверьте с помощью `curl localhost`.

3. **Настроить веб-сайт**

- Создать HTML-файл с указанным содержимым:

```html
<html>
<head>
<title>Лучший</title>
</head>
<body>
<h1>веб-сайт</h1>
</body>
</html>
```

- Скопировать HTML-файл в контейнер:

```sh
docker cp index.html nginx_container:/usr/share/nginx/html/
```

4. **Создать пользовательский образ**

```sh
docker commit nginx_container my_website:latest
```

5. **Удалить исходный контейнер**:
- Удалить исходный контейнер (`nginx_container`) и убедиться, что он был успешно удален.

```sh
docker rm -f nginx_container
```

6. **Создание нового контейнера**:
- Создайте новый контейнер, используя созданный вами пользовательский образ (так же, как и исходный контейнер).

```sh
docker run -d -p 80:80 --name my_website_container my_website:latest
```

7. **Тестовый веб-сервер**:
- Используйте команду `curl` для доступа к веб-серверу по адресу `127.0.0.1:80`.

```sh
curl http://127.0.0.1:80
```

8. **Анализ изменений образа**:
- Используйте команду `docker diff` для анализа изменений, внесенных в новый образ.

```sh
docker diff my_website_container
```

- Объясните вывод команды `docker diff` в файле `submission6.md`.

## Задача 3: Контейнерные сети

**Цель**: Изучить основы сетей Docker.

1. **Создание сети**:
- Создание мостовой сети с именем `lab_network`

```sh
docker network create lab_network
```

2. **Запуск подключенных контейнеров**:
- Запуск двух контейнеров Alpine, подключенных к сети:

```sh
docker run -dit --network lab_network --name container1 alpine ash
docker run -dit --network lab_network --name container2 alpine ash
```

3. **Проверка подключения**:
- Из `container1` выполните ping `container2` по имени:

```sh
docker exec container1 ping -c 3 container2
```

4. **Документация**:
- Запишите вывод ping в `submission6.md`
- Объясните, как работает внутреннее разрешение DNS Docker

## Задача 4: Объем Сохранение

**Цель**: Понять сохранение данных в контейнерах.

1. **Создать том**:
- Создать именованный том `app_data`:

```sh
docker volume create app_data
```

2. **Запустить контейнер с томом**:
- Запустить Nginx с смонтированным томом:

```sh
docker run -d -v app_data:/usr/share/nginx/html --name web nginx
```

3. **Изменить содержимое**:
- Создать пользовательский файл `index.html`
- Копировать на том:

```sh
docker cp index.html web:/usr/share/nginx/html/
```

4. **Проверить сохранение**:
- Остановить и удалить контейнер:

```sh
docker stop web && docker rm web
```

- Создать новый контейнер с тем же томом:

```sh
docker run -d -v app_data:/usr/share/nginx/html --name web_new nginx
```

- Проверка сохранения содержимого с помощью `curl localhost`

## Задача 5: Проверка контейнера

**Цель**: Проверка внутреннего содержимого контейнера.

1. **Запустить контейнер Redis**:

```sh
docker run -d --name redis_container redis
```

2. **Проверка процессов**:
- Найти процесс сервера Redis:

```sh
docker exec redis_container ps aux
```

3. **Проверка сети**:
- Получить IP-адрес контейнера:

```sh
docker inspect -f '{{range.NetworkSettings.Networks}}{{.IPAddress}}{{end}}' redis_container
```

4. **Различия в документах**:
- Сравнить `docker exec` и `docker attach` в `submission6.md`
- Объяснить варианты использования для каждого

## Задача 6: Операции по очистке

**Цель**: Практика управления ресурсами.

1. **Создание тестовых объектов**:
- Создание 3 остановленных контейнеров:

```sh
for i in {1..3}; do docker run --name temp$i alpine echo "hello"; done
```

- Создание 2 висячих образов:

```sh
docker build -t temp-image . && docker rmi temp-image
```

2. **Удаление остановленных контейнеров**:

```sh
docker container prune -f
```

3. **Удаление неиспользуемых образов**:

```sh
docker image prune -a -f
```

4. **Проверка очистки**:
- Проверка использования диска до/после:

```sh
docker system df
```

- Документируйте экономию места в `submission6.md`

### Рекомендации

- Используйте правильное форматирование и структуру Markdown для файлов документации.
- Организуйте файлы в папке лаборатории, используя соответствующие соглашения об именовании.
- Создайте запрос на извлечение в основную ветку репозитория с выполненным лабораторным заданием.

> Примечание: сосредоточьтесь на понимании архитектуры Docker, а не просто на выполнении команд.
> 
