# Введение в инструменты DevSecOps

В этой лабораторной работе вы изучите основные практики DevSecOps, выполняя сканирование безопасности контейнеров и веб-приложений с использованием стандартных отраслевых инструментов. Вы научитесь выявлять уязвимости в безопасной, контролируемой среде, используя намеренно уязвимые цели.

## Задание 1: Сканирование веб-приложений с помощью OWASP ZAP

**Цель**: Выполнить автоматическое сканирование безопасности уязвимого веб-приложения с помощью OWASP ZAP в Docker для выявления распространённых веб-уязвимостей. Сканирование веб-приложений помогает обнаружить такие уязвимости безопасности, как XSS, SQL-инъекции и ошибки конфигурации, до того, как злоумышленники ими воспользуются. ZAP — это стандартный отраслевой инструмент, поддерживаемый OWASP.

1. **Запустите уязвимое целевое приложение** (Juice Shop):

```bash
docker run -d --name juice-shop -p 3000:3000 bkimminich/juice-shop
```

Убедитесь, что оно запущено: `http://localhost:3000` в вашем браузере

2. **Сканируйте с помощью OWASP ZAP**:

```bash
docker run --rm -u zap -v $(pwd):/zap/wrk:rw \
-t ghcr.io/zaproxy/zaproxy:stable zap-baseline.py \
-t http://host.docker.internal:3000 \
-g gen.conf \
-r zap-report.html
```

> *Примечание*:
> - Mac/Windows: Используйте `host.docker.internal`, как указано выше
> - Linux: Замените на свой IP-адрес локальной сети компьютера. Вы можете использовать следующую команду: `ip -f inet -o addr show docker0 | awk '{print $4}' | cut -d '/' -f 1`

3. **Проанализируйте результаты**:

- Найдите HTML-отчёт в текущем каталоге: `zap-report.html`

- Откройте его в браузере и определите:
- 2 уязвимости среднего уровня риска
- Состояние заголовков безопасности

4. **Очистка**:

```bash
docker stop juice-shop && docker rm juice-shop
```

---

## Задание 2: Сканирование уязвимостей контейнеров с помощью Trivy

**Цель**: Выявить уязвимости в образах контейнеров с помощью Trivy, запущенного через Docker, уделяя особое внимание намеренно уязвимым образам в образовательных целях. Сканирование контейнеров выявляет уязвимости ОС/библиотек в образах перед их развертыванием. Trivy — самый полный сканер с открытым исходным кодом в отрасли.

1. **Сканирование с помощью Trivy в Docker**:

```bash
docker run --rm -v /var/run/docker.sock:/var/run/docker.sock \
aquasec/trivy:latest image \
--severity HIGH,CRITICAL \
bkimminich/juice-shop
```

2. **Анализ результатов**:
- Определить:
- Общее количество КРИТИЧЕСКИХ уязвимостей
- 2 имени уязвимых пакетов
- Наиболее распространённый тип уязвимости

3. **Очистка**:

```bash
docker rmi bkimminich/juice-shop
```

---

## Правила отправки

1. Создать `submission9.md` с:

``markdown
## Результаты задания 1
- Обнаружено уязвимостей Juice Shop (среднего уровня): [Количество]
- Наиболее Обнаружена интересная уязвимость: [Имя]

- Заголовки безопасности присутствуют: [Да/Нет]

## Результаты задания 2
- Критические уязвимости в образе Juice Shop: [Количество]
- Уязвимые пакеты:
1. [Пакет 1]
2. [Пакет 2]
- Основной тип уязвимости: [например, SQLi, XSS]
```

2. Приложите скриншоты:
- Обзор отчёта ZAP HTML
- Вывод терминала Trivy, показывающий критические результаты

3. Отправьте запрос на извлечение в репозиторий курса.

> **Примечание о безопасности**: Все сканирования намеренно нацелены на уязвимые контейнеры/веб-приложения, работающие локально. Никогда не запускайте автоматизированные сканеры на производственных системах без явного разрешения.
